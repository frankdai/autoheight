<!DOCTYPE html>
<html>
<head>
    <title>Auto Height</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="http://necolas.github.io/normalize.css/3.0.1/normalize.css">
    <style type="text/css">
    div {
        box-sizing:border-box;
        margin-bottom: 15px;
    }
    </style>
    <script type="text/javascript">
    (function(){
    if (window.AutoHeight) {
        return
    } 
    else {
        window.AutoHeight=function(element) {
            var controls=document.getElementsByClassName('autoheight');
            var setHeight,i,ratio,includingBorder;
            if (this===window) {
                for (i=0;i<controls.length;i++){
                    ratio=controls[i].getAttribute('data-autoheightratio')||1;
                    includingBorder=controls[i].getAttribute('data-includingborder')||true;
                    setHeight=includingBorder?controls[i].offsetWidth:controls[i].clientWidth;
                    controls[i].style.height=setHeight*ratio+'px';
                }
            }
            else {
                element.controlHeight=function(ratio,includingBorder){
                    var height;
                    ratio=ratio||1;
                    includingBorder=includingBorder||true;
                    height=includingBorder?element.offsetWidth:element.clientWidth;
                    element.style.height=height*ratio+'px';
                };
            }
            return element;
        }
    }
    })()
    </script>
</head>
<body>
    <p>Please resize the browser to see the effect</p>
    <div class="div1 autoheight" style="width:20%;background:#ddd;border:5px solid black;">First Div</div>
    <div class="div2 autoheight" data-autoheightratio="1" data-includingborder="false" style="width:20%;background:#999;border:5px solid black;">Second Div</div>
    <div id="div3" style="width:30%;background:#555;border:5px solid black;">Third Div</div>
    <div id="div4" style="width:30%;background:#222;border:5px solid black;">Fourth Div</div>
    <script type="text/javascript">
    AutoHeight();
    var div3=new AutoHeight(document.getElementById('div3'));
    var div4=new AutoHeight(document.getElementById('div4'));
    div3.controlHeight();
    div4.controlHeight(0.4,false);
    window.addEventListener('resize',function(){
        AutoHeight();
        div3.controlHeight();
        div4.controlHeight(0.4,false);
    },true);
    </script>
</body>
</html>
